# podm4osmand

Как загрузить [карту Подмосковья](http://slazav.xyz/maps/podm_txt.htm)
c [slazav.xyz](http://slazav.xyz/) для автономного просмотра
в [OsmAnd](https://osmand.net/) для Android.

Здесь описана загрузка растрового варианта карты в формате `Metainfo` для OsmAnd.
Карты в этом формате содержат тайлы в виде отдельных png файлов, организованных
в следующую иерархию каталогов: `{z}/{x}/{y}png.tile`. В корне этой иерархии
хранится файл конфигурации, который называется [.metainfo](tiles/.metainfo).

Карта в таком формате занимает примерно 665M
и содержит около 40 тысяч тайлов (до 14 уровня zoom включительно).

[Обзорная карта](http://slazav.xyz/maps/podm/all_podm.htm)

## Настройка OsmAnd для Android

[Online maps plugin for OsmAnd](https://osmand.net/features/online-maps-plugin)

При наличии карты памяти рекомендуется в настройках OsmAnd перенести
карты на неё (`Настройки/Настройка OsmAnd/Папка хранилища данных`).

Для поддержки растровых карт надо включить плагин Онлайн карт:
`Настройки/Плагины/Онлайн-карты`.
После этого можно добавлять растровые карты и спутниковые снимки из разных источников.

Для добавления нового источника нужно выбрать `Настройки карты/Источник карты/Добавить`.
В настройках источника ввести следующее:

Настройка | Значение
--- | ---
Имя | slazav
URL | http://slazav.xyz/tiles/podm/{x}-{y}-{z}.png
Уровни масштаба | min 5 - max 14
Время устаревания | Никогда
Формат хранения | Каждый тайл в своём файле

После сохранения настроек карту уже можно смотреть в онлайн-режиме.

Загруженные при просмотре тайлы будут сохранятся в локальных файлах
в папке `Android/data/net.osmand.plus/files/tiles/slazav/`.
Там же будет находиться файл `.metainfo`, содержащий описанные выше настройки.

## Загрузка тайлов для автономного просмотра

Для работы с картой без подключения к сети нужно загрузить все необходимые тайлы.

Самый простой способ загрузки - средствами самого OsmAnd.
Для этого нужно выбрать необходимую область на карте,
и "долгим" нажатием открыть контекстное меню.
Далее выбрать `Действия/Загрузить карту`,
и задать необходимый диапазон мастабов для загрузки.

Таким образом можно загрузить отдельные фрагменты карты.
Для загрузки всей карты целиком этот способ не очень удобен -
может потребоваться несколько часов для загрузки 40 тысяч тайлов.

Поэтому ниже описана процедура загрузки тайлов с компьютера (Ubuntu Linux).

